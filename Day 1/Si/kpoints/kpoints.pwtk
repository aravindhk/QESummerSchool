::pwtk::import ../Si.pwtk

set ks "2 4 6 8"

set results [open E-vs-nkpts.dat w]

foreach k $ks {

    set head Si.kpoints-$k\x$k\x$k
    outdir [outdir_prefix]/$head
    K_POINTS automatic "$k $k $k 1 1 1"

    runPW scf.$head
    set Etot [::pwtk::pwo::totene scf.$head.out]
    puts $results "$k $Etot"
    
} 

close $results
